<HTML>
<HEAD>
<TITLE>W3C Library Internals</TITLE>
<!-- Changed by: Henrik Frystyk Nielsen,  8-Nov-1995 -->
<NEXTID N="z78">
</HEAD>
<BODY>

<A HREF="../../../"><IMG ALT="W3C" SRC="../../../Icons/WWW/w3c_48x48.gif"></A>
<A HREF="../../"><IMG ALT="Lib" SRC="../../../Icons/WWW/Lib48x.gif"></A>
<IMG ALT="LibGuide" SRC="../../../Icons/WWW/internals48x.gif">

<H1>W3C Library Internals</H1>

<IMG SRC="../../../Icons/WWW/construction.gif"> Any suggestions or
ideas are welcome at <A HREF="mailto:libwww@w3.org">libwww@w3.org</A>. <P>

This guide describes the modules and their internal relations in the
<A HREF="../../">W3C Reference Library</A>. Every module in the
Library has a HTML document associated with it containing a detailed
description of the functionality and interface to other modules. This
page is the top node for the implementation specific documentation and
contains links to all the modules in the Library.  The documentation
is dynamically kept up to date as the actual include files (.h) are
generated from the HTML documents using the <A
HREF="../../../LineMode/">Line Mode Browser</A>. <P>

<IMG ALIGN=BOTTOM SRC="../../../Icons/32x32/caution.gif" ALT="NOTE">
This document is also available as <A HREF="choppy.html"><B>one big
HTML file</B></A> intended for printout. Please note that not all
links in this version work!<P>

<H2>Table of Contents</H2> 

<OL>

<LI><A HREF="Core.html">Core Modules</A>
<LI><A HREF="Prefs.html">Application Preferences</A>
<LI><A HREF="App.html">Application Specific Implementations</A><P>

<LI><A HREF="Network.html">Network Specific Modules</A>
<LI><A HREF="Protocol.html">Protocol Modules</A>
<LI><A HREF="ProtocolUtils.html">Protocol Utility Modules</A>
<LI><A HREF="Threads.html">Libwww Thread Modules</A><P>

<LI><A HREF="Central.html">Central Data Structures</A>
<LI><A HREF="Streams.html">Generic Streams</A>
<LI><A HREF="StrucStreams.html">Structured Streams</A>
<LI><A HREF="Presentation.html">HTML Presentation Modules</A>
<LI><A HREF="Styles.html">Style Sheets</A><P>

<LI><A HREF="URI.html">URI Management</A>
<LI><A HREF="Utils.html">Generic Programming Utilities</A>

</OL>

When compiling the Library please make sure that you have a relatively
new version of the <A HREF="../../../LineMode/">Line Mode Browser</A>
that parses the HTML documents correctly (2.13 and newer
versions). Find out what version of the Line Mode Browser you are
using by typing

<PRE>
	./www -version
</PRE>

Also remember that when editing the module interfaces or adding
functionality then always use the HTML files and not the .h
files! <P>

<H1>Core Modules</H1>

The "<A HREF="../Architecture/DesignModel.html">core modules</A>" are
the fundamental part of the Library. The core entity contains hooks
for the dynamic modules and provides the major access points for
applications issuing requests, for example to access a data object.

<DL>

<DT><A HREF="../../Implementation/WWWLib.html">WWWLib Include</A>
<DD>This is not really a core module, but an important part as this is
the only include file you need to use the Library.

<DT><A HREF="../../Implementation/HTAccess.html">Access Manager</A>
<DD>The access manager is the main entry point for requesting a data
object pointed to by a URI. It has a set of methods that allows the
application to request different services, for example to get a URI,
post a URI, or to search a URI.

<DT><A HREF="../../Implementation/HTProt.html">Protocol Manager</A>
<DD>The protocol manager is invoked by the access manager in order to
access a document not found in memory or in file cache. The manager
consists of a set of protocol modules handling the access schemes
HTTP, FTP, NNTP, Gopher, WAIS, Telnet, and access to the local file
system. The protocol modules are registered dynamically (using static
linking) and the <A HREF="../Using/">User's Guide</A> describes how
modules can be registered. Each protocol module is responsible for
establishing the connection to the remote server (or the local
file-system) and extract information using a specific access
method. When data arrives from the network, it is passed on to the
format manager.

<DT><A HREF="../../Implementation/HTFormat.html">Format Manager</A>
<DD>The stream format manager takes care of data format conversion
requested based on a set of registered format converters and a simple
algorithm for selecting the best conversion.

<DT><A HREF="../../Implementation/HTFWrite.html#z3">Cache Manager</A>
<DD>The cache manager is used to save data objects once they have been
down loaded from the network. The cache uses the hierarchy indicated
in the URLs as a way to identify items in the cache but is still under
construction and requires a lot of work to be a highly efficient cache
manager!

<DT><A HREF="../../Implementation/HTError.html">Error Manager</A>
<DD>This module manages an information stack which contains
information of all errors occurred during the communication with a
remote server or simply information about the current state. Using a
stack for this kind of information provides the possibility of nested
error messages where each message can be classified and filtered
according to its impact on the current request, for example "Fatal",
"Non-Fatal", "Warning" etc. The filtering can be used to decide which
level of messages will be passed back to the user.
 
<DT><A HREF="../../Implementation/HTEvntrg.html">Event Manager</A>
<DD>The event manager is a "session layer" handling which thread
should be the active thread. A thread can either be an internal libwww
thread or an external thread, for example a Posix thread, and the
event manager can itself be either the internal Library manager or an
external event manager. Currently the internal event manager uses a
select function call to decide which thread should be made the active
one, however an external event manager can use another decision
model. The event manager is described together with the internal
thread model in the section "<A
HREF="../Architecture/Threads.html">Libwww Threads</A>", and more
modules are described in the section <A HREF="Threads.html">Libwww
thread Modules</A>

</DL>

<H1>Application Preferences</H1>

These modules handles all the modules that can be registered either
dynamically (using static binding) or statically by the application. 

<H2>Default Initializations</H2>

The <A HREF="../../Implementation/HTInit.html">HTInit module</A>
defines a <A HREF="../../Implementation/HTInit.c">standard set of
initializations</A> where all protocol modules and converters are
setup at startup time of the application in the <A
HREF="../../Implementation/HTAccess.html#Library">HTLibInit()</A>. Often
you can take this module and just override it with your own
preferences.

<H2>Handling a Configuration File</H2>

Bindings can also be set up by a rule file that is handled by the <A
HREF="../../Implementation/HTRules.html">Configuration File
Manager</A>. The format of the rule file is yet to be specified and it
does still need some work.

<H2>Bindings to the local file system</H2>

The <A HREF="../../Implementation/HTBind.html">Bind Module</A> makes
bindings between file suffixes and content-type, content-language,
charset etc. As an application this is used when talking to, for
example FTP servers that do not support media types, and servers use
it when performing format negotiation between multiple representations
of a document.

<H2>Registering of Methods</H2>

The idea behind this module is to allow dynamic registration of HTTP
methods, for example PUT, POST, GET etc. and then also allow new
methods to be registered. This has not yet been implemented but the
structure is there :-)

<H2>Registration of Access Schemes</H2>

Access schemes like HTTP, FTP etc. can be registered dynamically
(using static binding) and the <A
HREF="../../Implementation/HTProt.html">HTProt module</A> provides the
support for this.


<H2>Registration of Proxies and Gateways</H2>

The <A HREF="../../Implementation/HTProxy.html">HTProxy Module</A>
provides functionality for registering proxies and gateways
dynamically. This has traditionally been handled by environment
variables, but is now a registration module just like the registration
of access schemes.

<H1>Application Specific Modules</H1>

When all public functions and variables within a module are
overwritten by module other than the one in the Library, the linker
takes the new version and ignores the module in the Library. The
following modules are implemented in the Library in order to support
the <A HREF="../../../LineMode/">Line Mode Browser</A> but can be
overwritten by GUI clients etc.

<H2>Displaying and Prompting User Messages</H2>

The <A HREF="../../Implementation/HTAlert.html">HTAlert module</A>
contains the code for prompting the user for file names, userid,
password etc. Furthermore, it presents messages containing status
information, error messages etc. to the user. The implementation in
the library is meant for the Line Mode Browser (i.e. it writes to
stderr) but can easily be overwritten by GUI browsers.

<H2>History Manager</H2>

The <A HREF="../../Implementation/HTHist.html">HTHist module</A>
records and replays on request the documents which the user
visits. There are no calls to this module within the Library so if the
application does not use it then it is not linked in at all. If the
application wants a more advanced history management, then this should
be overwritten.

<H2>Internal Event loop</H2>

The internal event loop in the <A
HREF="../../Implementation/HTEvntrg.html">HTEvtrg module</A> is made to
support <A HREF="../Architecture/Threads.html">libwww threads</A> If
an application wants its own event loop, then this module must be
overwritten.

<H2>Default Initializations</H2>

The <A HREF="../../Implementation/HTInit.html">HTInit module</A>
defines a standard set of initializations where all protocol modules
and converters are setup at startup time of the application in the <A
HREF="../../Implementation/HTAccess.html#Library">HTLibInit()</A>. Often
you can take this module and just override it with your own
preferences.

<H1>Network Modules</H1>

Network modules handles all the network access including DNS access,
reading and writing to the and from the network etc. Most of these
modules are internal to the Library, however some applications might
use some of them directly.

<H2>TCP Communication</H2>

The functionality of the <A HREF="../../Implementation/HTTCP.html">
HTTCP Module</A> covers several topics but they are all related to
TCP/IP communication. All active and passive connection establishment
from the <A HREF="Protocol.html">Protocol Modules</A> goes through
this module. Furthermore, the module manages a local host cache of
visited hosts so that the Domain Name Server is only consulted when
necessary.<P>

Other topics includes:

<UL>
<LI>I/O status indication (errno etc.)
<LI>Information on remote hosts
<LI>Information on local host (domain name etc.)
<LI>Information on current user (mail address)
</UL>

<H2>Reading Data from a Socket</H2>

The <A HREF="../../Implementation/HTSocket.html">HTSocket Module</A>
controls all the functionality for reading information from a socket
and from the local file system using either a socket or a ANSI C file
descriptor. <P>

The module is currently being transformed into a completely reentrant
version, but the old non-reentrant interface is still needed for some
functions. However, it will be taken out as soon as possible.

<H1>Protocol Modules</H1>

A protocol module is invoked by the <A
HREF="../../Implementation/HTAccess.html">HTAccess module</A> in order
to access a document. Each protocol module is responsible for handling
the transmission of a data object either from the application to a
remote server, or vice verse. <P>

The protocol modules are registered dynamically (using static linking)
and the <A HREF="../Using/">User's Guide</A> describes how modules can
be registered. Each protocol module is responsible for establishing
the connection to the remote server (or the local file-system) and
extract information using a specific access method. When data arrives
from the network, it is passed on to the format manager.<P>

Most of the protocol modules are now implemented as state machines in
order to support <A HREF="../Architecture/Threads.html">libwww
Threads</A>.

When the client parses a request to the library a <A
HREF="../../Implementation/HTAccess.html#z1">HTRequest Structure</A>
is filled out and parsed to a load function in the access manager, for
example <A HREF="../../Implementation/HTAccess.html">
HTLoadAnchor</A>. HTRequest contains all information needed by the
Library in order to fulfill a request.

<DL>

<DT><A NAME="z46" HREF="../../Implementation/HTFile.html">File access</A>

<DD>This module provides access to files on a local file system. Due
to general confusion of the "file://" access scheme in the <A
HREF="../../../Addressing/">URL Specifications</A> tries FTP access on
failure.

<DT><A NAME="z60" HREF="../../Implementation/HTFTP.html">FTP access</A>

<DD>This is a complete state based FTP client which is capable of
communicating with a lot of weird FTP servers. It uses
<CODE>PASV</CODE> as the default method for establishing the data
connection as <CODE>PORT</CODE> does not work if the application is
run from a firewall machine, as is often the case with <A
HREF="../../../Daemon/User/Proxies/Proxies.html">proxy server</A>.

<DT><A NAME="z45" HREF="../../Implementation/HTTP.html">HTTP access</A>

<DD>The <A NAME="25" HREF="../../Implementation/HTTP.html">HTTP
module</A> handles document search and retrieve using the <A
HREF="../../../Protocols/">HTTP</A> protocol. See also information on
the <A HREF="../Architecture/HTTPFeatures.html"> current
implementation</A> of the HTTP client. The module is now a complete
state machine which is a required functionality in the <A
HREF="../Architecture/Threads.html">libwww thread model</A>. It uses
streams for both outgoing and incoming data, the outgoing stream is
implemented in <A HREF="../../Implementation/HTTPReq.c"> HTTPReq.c</A>
and the incoming stream in <A
HREF="../../Implementation/HTTP.c">HTTP.c</A>

<DT><A NAME="z40" HREF="../../Implementation/HTNews.html">News access</A>

<DD>The NNTP internet news protocol is handled by HTNews which builds a
hypertext object. <P>

<IMG SRC="../../../Icons/WWW/construction.gif"> This module is under
reconstruction!

<DT><A NAME="z44" HREF="../../Implementation/HTGopher.html">Gopher access</A>

<DD>The internet gopher access to menus and flat files (and links to telnet
nodes, WhoIs servers, CSO Name Server etc.) is handled by <A NAME="26"
HREF="../../Implementation/HTGopher.html">HTGopher Module</A>.

<DT><A NAME="z72" HREF="../../Implementation/HTTelnet.html">Telnet access</A>

<DD>This module provides the possibility of running telnet sessions in
a subshell. It also provides functionality for rlogin and tn3270.

<DT><A NAME="z39" HREF="../../Implementation/HTWAIS.html">WAIS access</A>

<DD>WAIS access is not compiled into the Library by default as it
requires the freeWAIS library. This is easily changed in the platform
dependent <CODE>Makefile.include</CODE> in the

<PRE>
	WWW/All/&lt;platform&it;
</PRE>

directory. However, if this library is present then the application
can communicate directly with a WAIS server. Otherwise it must go
through a <A HREF="../../../Gateways/WAISGate.html"> gateway
program</A>.

</DL>

<H1>Protocol Utility Modules</H1>

The protocol modules themselves can be registered dynamically (using
static binding) but some of the functionality used by the modules are
kept in a set of protocol utility modules that are described in this
section.

<H2>Access Authorization</H2>

In order to prevent unauthorized access on a Web server, a basic
authorization scheme has been developed, see <A
HREF="../../../Protocols/"> Access
Authorization</A> for more details on the scheme. The access
authorization is implemented in the following modules:

<DL>

<DT><A HREF="../../Implementation/HTAABrow.html">HTAABrow</A>

<DD>This module contains WWW Browser specific code, that is composing
the HTTP Authorization Header, recording users information etc.

<DT><A HREF="../../Implementation/HTAAUtil.html">HTAAUtil</A>

<DD>This module contains the authorization code that is common to both the
servers and clients, e.g., handling information on different authentication
etc.

<DT><A HREF="../../Implementation/HTUU.html">UU Encoding and Decoding</A>

<DD>Provides functions to encode and decode a data buffer according to
the <A
HREF="http://info.internet.isi.edu/in-notes/rfc/files/rfc1421.txt">RFC
1421</A> "Privacy Enhancement for Internet Electronic Mail".

</DL>

<H2>Presenting Directory Listings and other Listings</H2>

When listings return from the protocol modules they are converted into HTML
and parsed to the client. Listings might be HTTP directory listings, Gopher
menus, FTP directory listings, CSO Name server etc. The modules providing this
functionality are:

<DL>

<DT><A HREF="../../Implementation/HTDir.html">HTDir</A>

<DD>This is a very configurable module to actually present the listings

<DT><A HREF="../../Implementation/HTDescpt.html">HTDescript</A>

<DD>This module handles the description field in a HTTP directory listing.
For a HTML file, the default action is to peek the title of the document.

<DT><A HREF="../../Implementation/HTIcons.html">HTIcons</A>

<DD>This module handles the set of icons used in the listings (HTTP, Gopher,
FTP etc.).

</DL>

<H2>Logging Requests</H2>

The <A HREF="../../Implementation/HTLog.html">HTLog Module</A> is a
simple log manager that can log the result of a request to the access
manager.

<H1>Thread Modules</H1>

From version 3.0 (unreleased) of the W3C Reference Library, support
for <A HREF="../Architecture/Threads.html">libwww threads</A> and
other thread models has been implemented multi threaded functionality
has been added as an extra set of modules. For the moment, only the
HTTP module can take full advantage of libwww threads but both FTP and
Gopher are foreseen for the same functionality. The modules included
are: <P>

<H2>Net	Manager</H2>

The <A HREF="../../Implementation/HTNet.html">HTNet module</A>
registers sockets as ready for read or write (this includes the
connect statement that is basically a write request). It is an
internal module to the Library.

<H2>Internal Event Loop</H2>

The <A HREF="../../Implementation/HTEvntrg.html">HTEvent module</A> is
the Library's own version of the event-loop serving the HTTP client,
and it is the application interface to the multi threaded
Library. Clients can either use this module as is or they can
overwrite it with their own even-loop. Note, that GUI-clients
<EM>can</EM> use the current implementation! <P> The module is now
ported to Windows NT thanks to <A
HREF="mailto:cbrooks@osf.org">Charlie Brooks</A>

<H1>Central Data Structures</H1>

The central data structures are the structures that are a part of the
core entity. Each of the core modules as explained in section "<A
HREF="../Architecture/ControlFlow.html">Control and Data Flow</A>"are
relying on one or more of the central data structures. This section
describes the relationship between the core modules and the central
data structures <EM>and</EM> the relationship between the central data
structures themselves. <P>

<H2>Anchors</H2>

All anchor management is handled by the <A
HREF="../../Implementation/HTAnchor.html#anchor">HTAnchor module</A>. You
should normally not have to look directly into the HTAnchor structure,
but use the methods provided by the anchor manager.

<H2>Request</H2>

The <A HREF="../../Implementation/HTAccess.html#z1">HTRequest
structure</A> is defined in the <A
HREF="../../Implementation/HTAccess.html">access manager</A>. It is
currently not a completely opaque data structure but it will soon be
so be prepared to use methods like the ones to handle the <A
HREF="../../Implementation/HTAnchor.html">HTAnchor Object</A> Then we
can also better call it an object and not a data structure ;-).

<H2>Streams</H2>

Almost each stream module has its specific implementation of the
stream structure, but the generic one is defined in the <A
HREF="../../Implementation/HTStream.html">HTStream Module</A>. The
structured stream definition is placed in the <A
HREF="../../Implementation/HTStruct.html">HTStruct module</A>. None of
these modules have any code directly associated with - this is left to
the specific stream modules, for example the <A
HREF="../../Implementation/HTFWrite.html">HTFWrite stream</A>.

<H2>HyperDoc Structure</H2>

The HyperDoc structure is different from the other central data
structures as it is only declared in the Library - the definition is
left to the application. It is intended to contain information about
data objects, especially hypertext objects that are to be presented to
a user. As an example of a definition, you can look at the <A
HREF="../../../LineMode/">Line Mode Browser</A> where it is defined in
the <A HREF="../../../LineMode/Implementation/GridText.html">GridText
module</A>. Here it is called "_HText" structure and it contains all
information needed to present and manage a data object in a text based
environment. <P>

Even though the Library does not interfere with the contents of the
HyperDoc object it does provide an API for managing the object. This
API is known as the "<A HREF="../../Implementation/HText.html">HText
API</A>" and it is described further in the User's Guide

<H1>Stream Modules</H1>

A <A HREF="../../Implementation/HTStream.html">stream</A> is an object
which accepts sequences of characters. It is a destination of data
which can be thought of much like an output stream in C++ or an ANSI
C-file stream for writing data to a disk or another peripheral
device. The Library defines a generic stream class in the <A
HREF="../../Implementation/HTStream.html">HTStream module</A>, but
almost all stream modules define their own sub class definition of the
stream object.

<H2>Protocol Streams</H2>

These are normally internal streams that parses or generates protocol
specific information to communicate with remote servers.

<DL>
<DT><A HREF="../../Implementation/HTTPReq.html">HTTP Request Stream</A>
<DD>This stream is one of the first real protocol streams - more are to come!
</DL>

<H2>Converters and Presenters</H2>

Streams that can be used to convert data from one media type to
another or create a graphic object and present it to the user. These
are streams that save the data to a local file and then calls an
external program, for example a postscript viewer. These are normally
initialized as a <A HREF="Prefs.html">application preference</A>.

<DL>

<DT><A HREF="../../Implementation/SGML.html">SGML Tokenizer</A>
<DD>Parses the data and generates a <A HREF="StrucStreams.html">
structured stream</A>. Each parser instance is created with reference
to a particular DTD structure.

<DT><A HREF="../../Implementation/HTMLGen.html">Plain to HTML Converter</A>
<DD>This stream takes a plain file and converts it into HTML. Like the
SGML tokenizer, it also converts a generic stream into a structured
stream.

<DT><A HREF="../../Implementation/HTPlain.html">Plain Text Presentation</A>
<DD>Takes plain ASCII text and presents it to the user as preformatted text.

<DT><A HREF="../../Implementation/HTMIME.html">HTTP/MIME header parser</A>
<DD>Parse a MIME format message and puts all the information in an <A
HREF="../../Implementation/HTAnchor.html">Anchor object</A>

<DT><A HREF="../../Implementation/HTWSRC.html">WAIS source file Stream</A>
<DD>Parses a <EM>WAIS source</EM> description file. By default, this
is enabled even if direct WAIS access is not present (no linking with
the freeWAIS library).

<DT><A HREF="../../Implementation/HTGuess.html">Guessing Stream</A>
<DD>If the input format is unknown at the time when putting up a
stream stack, then this module scans a part of the stream and on a
statistical basis determines the type of stream needed from the <A
HREF="../../../Protocols/">content-type</A>.

<DT><A HREF="../../Implementation/HTXParse.html">External Parser with Call back</A>
<DD>This is a call back stream module where the implementation is
defined in the application and not in the Library.

<DT><A HREF="../../Implementation/HTFWrite.html">Save Locally</A>
<DD>The <EM>HTSaveLocally</EM> stream saves the data object to a local file.

<DT><A HREF="../../Implementation/HTFWrite.html">Save Locally and Execute Application</A>
<DD>The <EM>HTSaveAndExecute</EM> stream saves the data object to a
local file and calls an external application, for example a post
script viewer.

<DT><A HREF="../../Implementation/HTFWrite.html">Save Locally and Execute Application</A>
<DD>The <EM>HTSaveAndCallBack</EM> stream saves the data object to a
local file, calls an external application and when the stream is
freed, the libwww application gets called with a specified call back
function.

</DL>

<H2>I/O Streams</H2>

Streams that can write data to a socket or an ANSI C FILE object.
This can be used when redirecting a request to a local file of when
saving a document in the cache.

<DL>

<DT><A HREF="../../Implementation/HTFWrite.html">ANSI C File Writer stream</A>
<DD>Writes to an ANSI C FILE * object, as opened by fopen, etc.

<DT><A HREF="../../Implementation/HTFWrite.html#cache">Cache Writer Stream</A>
<DD>This is the stream that's used by the <A
HREF="../../Implementation/HTFWrite.html#cache">cache manager</A>

<DT><A HREF="../../Implementation/HTWriter.html">Socket Writer Stream</A>
<DD>Writes to a socket or something opened with the UNIX file I/O open
function.

<DT><A HREF="../../Implementation/HTNetTxt.html">Net to Text Converter</A>
<DD>Converts "Net ASCII" line terminators <CODE>&lt;CRLF&gt;</CODE>
into the equivalent C representation which is a '\n'.

</DL>

<H2>Basic Streams</H2>

A set of basic utility streams with no or little internal contents
but required in order to cascade streams.

<DL>

<DT><A NAME="z75" HREF="../../Implementation/HTTee.html">Tee Stream</A>
<DD>Just writes into two streams at once. Useful for taking a copy for a cache.

<DT><A HREF="../../Implementation/HTFWrite.html">Black Hole</A>
<DD>A quite expensive way of piping data into a hole for then to be forgotten forever.

<DT><A HREF="../../Implementation/HTFWrite.html">Through Line</A>
<DD>A short circuited stream that returns the same output sink as it is called with.

</DL>

<H1>Structured Stream Modules</H1>

The <A HREF="../../Implementation/SGML.html">SGML stream</A> generates
a structured stream that is sub class of a <A
HREF="Streams.html">generic stream</A>. The Library defines a
structured stream class in the <A
HREF="../../Implementation/HTStruct.html">HTStruct module</A>, but
almost all stream modules define their own sub class definition of the
stream object. <P>

A structured stream uses a DTD definition expressed in a C data
structure - no, it doesn't not understand a real DTD (yet). The
definition of the HTML DTD is placed in the <A
HREF="../../Implementation/HTMLPDTD.html">HTMLPDTD module</A>.

<DL>

<DT><A HREF="../../Implementation/HTML.html">HTML Presentation</A>
<DD>The <EM>HTMLPresent</EM> stream presents a HTML object to the user
using the "HText API" as explained in the section on <A
HREF="Presentation.html">HTML Presentation</A>.

<DT><A HREF="../../Implementation/HTMLGen.html">HTML Generation</A>
<DD>The <EM>HTMLGenerator</EM> stream generates a HTML object which
for example can be written to a file.

<DT><A HREF="../../Implementation/HTMLGen.html">HTML to C conversion</A>
<DD>The <EM>HTMLToC</EM> stream converts an HTML object into a C
compliant text object. This is for example used by the <A
HREF="../../../LineMode/">Line Mode Browser</A> in order to generate C
like include files from the HTML files that you have been reading
throughout this document.

<DT><A HREF="../../Implementation/HTTeXGen.html">HTML to LaTeX Conversion</A>
<DD>The <EM>HTMLToTeX</EM> stream is a very simple HTML to LaTeX
converter. It is not error free but a start.

<DT><A HREF="../../Implementation/HTMLGen.html">HTML to Plain Text Converter</A>
<DD>The <EM>HTMLToPlain</EM> stream takes a HTML object and converts
it into plain text using the styles in the "HText API"

</DL>

<H1>Presentation Modules</H1>

<H2>Generating a Graphic Object</H2>

This document describes the methods provided for presentation a <A
HREF="./#GraphicObject">graphic object</A> to the user. The
implementation in the Library is made for a text oriented browser, so
more advanced GUI clients must overwrite some of these modules. See
more information on which <A HREF="./#Overwrite">modules to
overwrite</A>.

As mentioned in the <A HREF="../Using.html">how to get started
guide</A>, the definition of a graphic object is free for the
application. Some graphic objects work by storing the whole structure
of the document.  Others work by converting the nested structure into
a linear sequence of styled text for display. <P>

Generally, a new platform has a new implementation of the hypertext
object. A GUI client must overwrite the graphic object modules in the
Library in order to take advantage of a more advanced
user-interface. The graphic object as defined in the Library has two
interfaces, depending on how much of the Library code the client wants
to handle on its own:

<P><IMG SRC="Interfaces.gif"><P>

<DL>

<DT>SGML Level

<DD>If the client has its own HTML parser then the interface is
between the client HTML parser and the Library SGML parser. The SGML
parser is a general SGML parser which can be setup with a specific DTD
and it feeds the HTML parser with structured data. In this case, you
will be emulating the <A HREF="../../Implementation/HTML.c">HTML
module</A>, and generating a hypertext object from the structured
stream. The actual structured stream definition is in the <A
HREF="../../Implementation/SGML.html">SGML module</A>.

<DT>HTML Level

<DD>If the client wants to use the HTML parser in the Library then
this is the second interface to the Library. The hypertext object is
parsed and the communication with the client is based on a set of
call-back functions in the HTML parser. The call-back functions are
all defined as prototypes in the <A
HREF="../../Implementation/HText.html">HText module</A> but the client
must provide the actual code that defines the presentation method used
for a specific HTML tag. If you wish to maintain the structure of the
SGML file within your object, then the SGML interface will be a better
place to connect your code.

</DL>

You are free to define the structure of the hypertext object (the
structure is left undefined in the <A
HREF="../../Implementation/HText.html">HText module</A>. You may want to
define your own styles and font definitions. <P>

</DL>

<H1>Style Sheets</H1>

<IMG SRC="../../../Icons/32x32/caution.gif"> We are currently working
on implementing a <A HREF="../../../MarkUp/./">HTML level
3</A> parser in the Library, so the following description will soon be
out of date. <P>

The <A HREF="../../Implementation/HTStyle.html">Style module</A> in
the Library currently only handles a flat style structure with no
functionality for nested styles. You don't have to use this module, as
you can replace the entry points in the <A
HREF="../../Implementation/HTML.html">HTML module</A> with your own,
to prevent the library version from being loaded.<P>

</DL>

<H1>URI Management</H1>

The functionality for handling URIs is placed in the following modules:

<H2>Parsing URIs</H2>

The <A HREF="../../Implementation/HTParse.html">HTParse module</A>
provides functions for parsing URIs, simplify them by removing
redundant information. This is automatically called by the <A
HREF="../../Implementation/HTAnchor.html">Anchor manager</A> every
time an anchor is created in order to minimize the number of redundant
anchors.

<H2>URI Encoding and Decoding</H2>

The <A HREF="../../Implementation/HTEscape.html">HTEscape module</A>
can search a URI for unsafe characteres and escape and unescape them
according to the <A HREF="../../../Addressing/">URI
Specifications</A>.

</DL>

<H1>Utilities</H1>

This document covers the basic programming utilities that can be used
in the client or server to make life easier.

<H2>Container Modules</H2>

These modules are generic data object storage modules that might be used
wherever convenient. The general rule for freeing memory from these modules is
that free methods handles data structures generated within the modules whereas
user data is for the caller to free. The modules consist of:<P>

<DL>
<DT><A NAME="z59" HREF="../../Implementation/HTBTree.html">Binary Trees</A>
<DD>This is a complete balanced binary tree that might be used for storage
and sort of a large number of data objects, e.g. filenames in directory
listings etc.

<DT><A NAME="z50" HREF="../../Implementation/HTChunk.html">Dynamic Strings</A>
<DD>A Chunk is a block wise expandable array of type (char *) and is a sort of
apology for real strings in C. Chunks make it easier to handle dynamic strings
of unknown size. It is often faster than using the String Copy Routines</A>.

<DT><A NAME="z77" HREF="../../Implementation/HTList.html">Linked Lists</A>
<DD>This module provides the functionality for managing a generic list of data
objects. The module is implemented as a single linked list using the scheme
<EM>first in - last out (FILO)</EM>.

<DT><A HREF="../../Implementation/HTAssoc.html">Association Lists</A>
<DD>This is a small module build on top of HTList that provides a way to
store <EM>Name-Value</EM> pairs in an easy way.

<DT><A HREF="../../Implementation/HTString.html">Strings</A>

<DD>Routines for dynamic arrays of characters include string copy,
case insensitive comparison etc. It also contains functions for
generating <B>date and time stamps</B>, <B>MessageID</B> etc.

<DT><A HREF="../../Implementation/HTAtom.html">Atoms</A>
<DD>Atoms are strings which are given representative pointer values so that
they can be stored more efficiently, and comparisons for equality done more
efficiently. The pointer values are in fact entries into a hash table.

</DL>

<H2>Basic Utilities</H2>

<IMG SRC="../../../Icons/32x32/caution.gif"> Look into these modules
before you start defining system dependent stuff. Most things are
already defined here! The list of basic utility modules are currently
as follows

<DL>
<DT><A HREF="../../Implementation/tcp.html">System specifics</A>
<DD>The <A HREF="../../Implementation/tcp.html">tcp.h</A> file
includes system-specific include files and flags for I/O to network
and disk. The only reason for this file is that the Internet world is
more complicated than Posix and ANSI.

<DT><A HREF="../../Implementation/HTUtils.html">Platform Independent macros</A>
<DD>The <A HREF="../../Implementation/HTUtils.html">HTUtil.h</A>
include file contains things we need everywhere, generally macros for
declarations, booleans, etc.

</DL>

<P>
<HR>
<ADDRESS>Henrik Frystyk, <A HREF="mailto:libwww@w3.org">libwww@w3.org</A>, November 1995</ADDRESS>
</BODY>
</HTML>
